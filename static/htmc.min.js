((t=/\$([a-zA-Z][a-zA-Z0-9_]*)/g,n=t=>`((el,__i=0)=>{\n${t}\n})`)=>{elr=(el,r=0)=>{let a=`/*${el.tagName}*/`;if("SCRIPT"==el.tagName&&el.getAttribute("type")&&"text/htmc"==el.getAttribute("type"))a+=`${el.innerText.replace(t,"$1.v")};__i++`;else if("TEMPLATE"==el.tagName&&el.getAttribute`for`){let r=el.getAttribute`for`,l=[...r.matchAll(t)],i=l.length>0;a+=n(`let ctr=document.createElement('${el.getAttribute("tag")||"div"}');ctr.loaded=1;el.after(ctr);\nfor(let attr of el.attributes){console.log(attr);ctr.setAttribute(attr.name,attr.value);}\n${i?"el.L=cmp(_=>{":"{"}dispose(ctr);ctr.innerHTML='';\nfor(${r.replace(t,"$1.v")}){\n\tlet cl=el.content.cloneNode(1);\n\tlet start = ctr.children.length;\n\tctr.appendChild(cl);\n\teval(elr(ctr,start))(ctr,start);\n}${i?`},[${l.map(t=>t[1]).join`,`}])`:"}"}`)}else{let l="";for(let n of el.attributes)if(n.name.startsWith`run`){let r=[...n.value.matchAll(t)],a=r.length;l+=`${a?"el.L=cmp(_=>{":"{"}\n${n.value.replace(t,"$1.v")}\n${a?`},[${r.map(t=>t[1]).join`,`}])`:"}"}\n`}else n.name.startsWith("on-")&&(l+=`el.addEventListener('${n.name.slice(3)}',e=>{${n.value.replace(t,"$1.v")}});`);for(;r<el.children.length;r++){let t=el.children[r],n=elr(t);t.loaded||"SCRIPT"==t.tagName||(n=`\n${n}(el${null!=r?".children[__i++]":""});`),"TEMPLATE"==t.tagName&&(n+="__i++"),l+=n}a+=n(l)}return a}})();class t extends EventTarget{#e;constructor(t){super(),this.#e=t}get v(){return this.#e}set v(t){this.#e!==t&&(this.#e=t,this.up())}up(){this.dispatchEvent(new CustomEvent("change"))}sub(t){return t(),this.addEventListener("change",t),n=>this.rmoveEventListener("change",t)}}class n extends t{constructor(n,r){super(n(...r)),this.ab=new AbortController;for(let a of new Set([...r]))a instanceof t&&a.addEventListener("change",t=>this.v=n(...r),{signal:this.ab.signal})}}dispose=el=>{el.L&&el.L.ab.abort();for(let t of el.children)dispose(t)},sig=n=>new t(n),cmp=(t,r)=>new n(t,r);let get=async(t,props={})=>{let n=document.createRange().createContextualFragment(await(await fetch(t)).text()).firstElementChild;return eval(`{${elr(n)}}`)(n),n},htmc=el=>{"string"==typeof el&&(el=document.getElementById(el)),eval(elr(el))(el)};