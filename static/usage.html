<!doctype html>
<html>
	<head>
		<script src='/htmc.js'></script>
		<script>addEventListener('DOMContentLoaded',_=>htmc('app'))</script>
	</head>
	<body id='app'>
		<script type='text/htmc'>
			//this is run within a function scope.
			let bar = 'foo'; //this is not a global, but accessable from run attrs
			let count = sig(0); //this is a signal
			console.log(count.v, $count); //accessing signal values can be done both ways
			count.sub(_=>console.log($count)); //subscribe to changes
			let baz = sig(0);
			let sum = cmp(_=>$count+$baz, [count,baz]); //computed signals
			let arr = sig(['foo','bar','baz']);
		</script>
		<!-- the element run is attached to is available -->
		<div run="el.innerText='foo'"></div>
		<!-- the $ symbol turns the attr into a cmp -->
		<div run="el.innerText=$sum"></div>
		<!-- use any event with on- -->
		<button
			run="el.innerText=$count"
			on-click="$count+=1"
		></button>
		<!-- for-templates add a div(default) after themselves then fill it -->
		<template for="let text of $arr"
			tag='div' style="background:red"
		>
			<div run="el.innerText=text"></div>
			<template for="let extra of [1,2,3]">
				<p run="el.innerText=extra"></p>
			</template>
		</template>
		<!-- htmc can take properties but won't be in the current scope -->
		<div run="fetch('/foo.html')
			.then(t=>t.text()).then(t=>{
				el.innerHTML=t;
				htmc(el.firstElementChild, {msg: 'hi'});
			})
		"><slot></slot></div>
	</body>
</html>
